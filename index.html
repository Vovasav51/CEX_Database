<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<title>–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è CSV/Excel —É Firestore</title>
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>
<h2>–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è CSV/Excel —É Firestore</h2>
<input type="file" id="fileInput" accept=".csv, .xlsx, .xls" />
<button onclick="uploadFile()">–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏</button>

<script>
  // üîπ –¢–≤—ñ–π firebaseConfig
  const firebaseConfig = {
    apiKey: "AIzaSyCeE3Sm3omKS3CvZEAUrDWNy75CQMSYFYs",
    authDomain: "cex-database.firebaseapp.com",
    projectId: "cex-database",
    storageBucket: "cex-database.firebasestorage.app",
    messagingSenderId: "140570970101",
    appId: "1:140570970101:web:f27b59f08c865bae0f42bc",
    measurementId: "G-CP4E1QQKRW"
  };

  // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è Firebase
  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  async function uploadFile() {
    const file = document.getElementById('fileInput').files[0];
    if (!file) {
      alert('–í–∏–±–µ—Ä–∏ —Ñ–∞–π–ª!');
      return;
    }

    const reader = new FileReader();
    reader.onload = async function(e) {
      let data = new Uint8Array(e.target.result);
      let workbook = XLSX.read(data, { type: 'array' });
      let sheetName = workbook.SheetNames[0];
      let sheet = XLSX.utils.sheet_to_json(workbook.Sheets[sheetName]);

      for (let row of sheet) {
        await db.collection("uploads").add(row);
      }
      alert("‚úÖ –î–∞–Ω—ñ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—ñ —É Firestore!");
    };
    reader.readAsArrayBuffer(file);
  }
</script>
</body>
</html>
